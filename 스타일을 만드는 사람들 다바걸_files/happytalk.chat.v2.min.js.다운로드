var Happytalk=function(){"use strict";var t=function(){function t(){this._events={},this._events={}}return t.prototype.on=function(t,e){this._events[t]=this._events[t]||[],this._events[t].push(e)},t.prototype.emit=function(t,e){this._events[t]&&this._events[t].forEach((function(t){t(e)}))},t}(),e=function(){return(e=Object.assign||function(t){for(var e,i=1,o=arguments.length;i<o;i++)for(var s in e=arguments[i])Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t}).apply(this,arguments)},i=function(){function t(){}return t.prototype.debounce=function(t,e){var i=void 0;return function(){i&&clearTimeout(i),i=setTimeout(t,e)}},t}(),o=function(){function t(t){var e=this;if(this._mouseOver=!1,this._mouseEventBlock=!1,this.SHADOW_SIZE=20,this.setChatWindow=function(t){var i,o,s=t.device,n=t.size+10;"pc"===s&&(e.$iframe.style.width=t.width+e.SHADOW_SIZE+"px",e.$iframe.style.height=t.height+n+e.SHADOW_SIZE+"px"),"mobile"===s&&(e.$iframe.style.left="0px",e.$iframe.style.right="0px",e.$iframe.style.bottom="0px",e.$iframe.style.width="100%",e.$iframe.style.height="100%"),(null===(i=e._siteInfo.chatview)||void 0===i?void 0:i.only)&&!(null===(o=e._siteInfo.chatview)||void 0===o?void 0:o.containerId)&&(e.$iframe.style.position="fixed"),e._siteInfo.showOnHover&&(e._mouseEventBlock=!0)},this._siteInfo=t,this.$iframe=document.createElement("iframe"),this.util=new i,"2"===t.partnerId)try{window.CAFE24API.getMemberID((function(t){var i=null!=t?",site_uid="+encodeURI(t):null;i?e.createIframe(i):e.createIframe()}))}catch(t){this.createIframe()}else this.createIframe()}return t.prototype._getDomain=function(){var t=document.getElementById("happytalkSDK").src.split("/"),e=t[2];return-1!==e.indexOf("local")?"https:"!=t[0]?"http://local-chat.happytalkio.com:3000":"https://local-design.happytalkio.com":"http:"===t[0]?"http://"+t[2].replace("chat-static","design"):-1!==e.indexOf("dev-design")||-1!==e.indexOf("dev-chat-static")?"https://dev-design.happytalkio.com":-1!==e.indexOf("patch-design")||-1!==e.indexOf("patch-chat-static")?"https://patch-design.happytalkio.com":-1!==e.indexOf("stg-design")||-1!==e.indexOf("stg-chat-static")?"https://stg-design.happytalkio.com":"https://design.happytalkio.com"},t.prototype._getIframeSrc=function(t){var e=this._siteInfo,i=e.siteId,o=e.siteName,s=e.categoryId,n=e.divisionId,a=e.params,r=void 0===a?"":a,h=e.partnerId,p=void 0===h?"":h,d=e.shopId,f=void 0===d?"":d,l=e.kakaoId,c=void 0===l?"":l,v=e.naverId,m=void 0===v?"":v,u=e.options,y=void 0===u?"":u,_=e.chatview,I=void 0===_?"":_,g=e.loadFromHeythere,w=void 0!==g&&g,E=""!==I&&I.only?"chatview":"button";return this._getDomain()+"/"+E+"?siteId="+i+"&siteName="+encodeURI(o)+"&categoryId="+s+"&divisionId="+n+"&params="+encodeURI(r).replace(/&/g,"%26")+(t||"")+"&partnerId="+p+"&shopId="+f+(c?"&kakaoId="+encodeURI(c):"")+(m?"&naverId="+m:"")+(y?"&options="+encodeURIComponent(JSON.stringify(y)):"")+(I?"&chatview="+encodeURIComponent(JSON.stringify(I)):"")+(w?"&loadFromHeythere=true":"")},t.prototype.addIframe=function(){var t,e,i,o;(null===(t=this._siteInfo.chatview)||void 0===t?void 0:t.only)&&(null===(e=this._siteInfo.chatview)||void 0===e?void 0:e.containerId)?null===(o=document.getElementById(null===(i=this._siteInfo.chatview)||void 0===i?void 0:i.containerId))||void 0===o||o.appendChild(this.$iframe):document.body.appendChild(this.$iframe)},t.prototype.createIframe=function(t){var e,i=this;this.$iframe.id="HappytalkIframe",this.$iframe.setAttribute("src",this._getIframeSrc(t)),this.$iframe.setAttribute("allowtransparency","true"),this.$iframe.setAttribute("frameborder","0"),this.$iframe.setAttribute("title","채팅상담"),this.$iframe.setAttribute("tabindex","0"),this.$iframe.style.colorScheme="light",this.$iframe.style.margin="0px",this.$iframe.style.zIndex="999999999",this.$iframe.style.width="1px",this.$iframe.style.height="1px",this.$iframe.style.position="fixed",this.$iframe.style.left="auto",this.$iframe.style.right="0",this.$iframe.style.bottom="0",(null===(e=this._siteInfo.chatview)||void 0===e?void 0:e.disableLoadEvent)?this.addIframe():window.addEventListener("load",(function(){i.addIframe(),s._firstLoad=!0})),this._siteInfo.dynamicScript&&this.addIframe(),s._firstLoad&&this.addIframe()},t.prototype.setButtonInfo=function(t){var e,i=this.SHADOW_SIZE/2;if(this._mouseEventBlock=!1,this.$iframe.style.position="fixed",this.$iframe.style.left="left"===t.position?t.left-i+"px":"auto",this.$iframe.style.right="right"===t.position?t.right-i+"px":"auto",this.$iframe.style.bottom=t.bottom-i+"px",this.$iframe.style.width=t.size+this.SHADOW_SIZE+"px",this.$iframe.style.height=t.chatButtonsHeight?t.chatButtonsHeight+this.SHADOW_SIZE+"px":"0px",this._siteInfo.showOnHover){var o=this._getPosition(),s=o.position,n=o.numberPx;this.$iframe.addEventListener("mouseover",this.onMouseover.bind(this,s,n)),this.$iframe.addEventListener("mouseleave",this.onMouseleave.bind(this,s)),this.$iframe.style[s]=-1*t.size+"px",this.$iframe.style.transition=s+" .2s"}null===(e=this.$iframe.contentWindow)||void 0===e||e.postMessage({type:"WINDOW_SIZE",value:{windowWidth:window.innerWidth,windowHeight:window.innerHeight}},"*")},t.prototype.onMouseover=function(t,e){var i=this;this._mouseOver=!0,this.$iframe.style[t]=e,setTimeout((function(){i._mouseOver=!1}),200)},t.prototype.onMouseleave=function(t){if(!this._mouseOver&&!this._mouseEventBlock){var e=Number(this.$iframe.style.width.split("px")[0])-this.SHADOW_SIZE;this.$iframe.style[t]=String(-1*e)+"px"}},t.prototype._getPosition=function(){var t=this.$iframe.style,e=t.left,i=t.right;return{position:"auto"!==i?"right":"left",numberPx:"auto"!==i?i:e}},t.prototype.postMessage=function(t,i){var o;null===(o=this.$iframe.contentWindow)||void 0===o||o.postMessage(e({type:t},i&&{value:i}),"*")},t}(),s=function(){function e(e){var i=this;this.htButtonLoaded=!1,this._receiveMessage=function(t){"SET_BUTTON_INFO"===t.data.type&&i._view.setButtonInfo(t.data.value),"COMPLETE_BUTTON_LOAD"===t.data.type&&(i.htButtonLoaded=!0,i.event.emit("happytalk:ready")),"SET_CHAT_WINDOW"===t.data.type&&(i._view.setChatWindow(t.data.value),i.event.emit("happytalk:open")),"UNSET_CHAT_WINDOW"===t.data.type&&i.event.emit("happytalk:close"),"CREATE_CHAT_ROOM"===t.data.type&&(i.event.emit("happytalk:createChatRoom"),i._view.postMessage("READY_CHAT_ROOM")),"OPEN_HAPPYTALK_CHANNEL"===t.data.type&&i.event.emit("happytalk:clickChannel"),"OPEN_KAKAOTALK_CHANNEL"===t.data.type&&i.event.emit("kakaotalk:clickChannel"),"OPEN_NAVERTALK_CHANNEL"===t.data.type&&i.event.emit("navertalk:clickChannel"),"CLICK_WEBVIEW_LINK"===t.data.type&&i.event.emit("webview:link",{url:t.data.value})},this._view=new o(e),this.event=new t,window.addEventListener("message",this._receiveMessage)}return e.prototype.open=function(){this._view.postMessage("OPEN_CHAT_WINDOW")},e.prototype.close=function(){this._view.postMessage("CLOSE_CHAT_WINDOW"),this.event.emit("happytalk:close")},e.prototype.linkToKakao=function(){this._view.postMessage("LINK_TO_KAKAO")},e.prototype.linkToNaver=function(){this._view.postMessage("LINK_TO_NAVER")},e.prototype.setParams=function(t){this._view.postMessage("SET_PARAMS",t)},e.prototype.sendText=function(t){this._view.postMessage("SEND_TEXT_MESSAGE",t)},e.prototype.sendImage=function(t){this._view.postMessage("SEND_IMAGE_MESSAGE",t)},e.prototype.endChat=function(){this._view.postMessage("END_CHAT")},e.prototype.updateConfig=function(t){this._view.postMessage("UPDATE_CONFIG",t)},e._firstLoad=!1,e}();
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */return s}();
